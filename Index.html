<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lemon Stand â€” Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù„ÙŠÙ…ÙˆÙ†Ø§Ø¯Ø©</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Tahoma, Arial, sans-serif; margin: 0; background:#fafafa; color:#111;}
  header { background:#f7d65a; padding:16px 20px; border-bottom: 2px solid #e0c23f;}
  h1 { margin:0; font-size: 22px;}
  main { display: grid; grid-template-columns: 1fr 380px; gap: 16px; padding: 16px; }
  @media (max-width: 980px){ main{ grid-template-columns: 1fr; } }
  .card { background:#fff; border:1px solid #e5e5e5; border-radius: 10px; padding: 14px; box-shadow: 0 1px 0 rgba(0,0,0,.04);}
  .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:end;}
  label{ display:block; font-size:13px; color:#333; margin-bottom:6px;}
  input, select { width:100%; padding:10px; border:1px solid #ddd; border-radius:8px; font-size:14px; background:#fff;}
  .grid-3{ display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;}
  .grid-2{ display:grid; grid-template-columns: repeat(2, 1fr); gap:10px;}
  .btn { padding: 10px 14px; border:0; border-radius: 8px; cursor:pointer; font-weight:600; }
  .btn-primary{ background:#111; color:#fff; }
  .btn-secondary{ background:#f1f1f1; }
  .muted{ color:#666; font-size:13px; }
  table{ width:100%; border-collapse: collapse; }
  th, td{ padding:8px; border-bottom:1px solid #eee; text-align: center; font-size:13px;}
  .pill{ display:inline-block; padding:4px 8px; border-radius:999px; background:#f3f3f3; font-size:12px; }
  .ok{ background:#e6f7ed; }
  .bad{ background:#fde8e8; }
  .warn{ background:#fff7e6; }
  footer{ padding: 10px 16px; color:#666; font-size:12px; }
</style>
</head>
<body>
  <header>
    <h1>ğŸ‹ Lemon Stand â€” Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù„ÙŠÙ…ÙˆÙ†Ø§Ø¯Ø©</h1>
    <div class="muted">Ù†Ø³Ø®Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø³Ø±ÙŠØ¹Ø© ØªØ­Ø§ÙƒÙŠ Ù„Ø¹Ø¨Ø© Apple II Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ© Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¨Ø³ÙŠØ·Ø©.</div>
  </header>

  <main>
    <section class="card">
      <div id="status">
        <div class="row">
          <div><strong>Ø§Ù„ÙŠÙˆÙ…:</strong> <span id="day">1</span> / <span id="totalDays">12</span></div>
          <div><strong>Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:</strong> <span id="weatherLabel"></span> <span class="muted" id="weatherNote"></span></div>
        </div>
        <div class="row" style="margin-top:6px;">
          <div class="pill">ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯: <span id="cash">50.00</span> $</div>
          <div class="pill">ğŸ‘¥ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø­ØªÙ…Ù„ÙˆÙ†: <span id="potential">-</span></div>
        </div>
      </div>

      <hr/>

      <div class="grid-3">
        <div>
          <label>Ø³Ø¹Ø± Ø§Ù„ÙƒÙˆØ¨ ($)</label>
          <input type="number" id="price" step="0.05" min="0" value="0.5">
        </div>
        <div>
          <label>Ø§Ù„Ù„Ø§ÙØªØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© (Ø¹Ø¯Ø¯)</label>
          <input type="number" id="ads" step="1" min="0" value="0">
          <div class="muted">Ø§Ù„ØªÙƒÙ„ÙØ©: 1$ Ù„ÙƒÙ„ Ù„Ø§ÙØªØ©</div>
        </div>
        <div>
          <label>Ø£ÙƒÙˆØ§Ø¨ ØªÙØ­Ø¶Ù‘ÙØ± Ø§Ù„ÙŠÙˆÙ… (Ø¹Ø¯Ø¯)</label>
          <input type="number" id="cupsToMake" step="1" min="0" value="30">
          <div class="muted">ÙŠØ±ØªØ¨Ø· Ø°Ù„Ùƒ Ø¨Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„ÙˆØµÙØ©.</div>
        </div>
      </div>

      <h3>Ø§Ù„ÙˆØµÙØ© (Ù„ÙƒÙ„ ÙƒÙˆØ¨)</h3>
      <div class="grid-3">
        <div>
          <label>Ù„ÙŠÙ…ÙˆÙ† (Ø­Ø¨Ø©/ÙƒÙˆØ¨)</label>
          <input type="number" id="lemonsPerCup" step="0.1" min="0" value="0.5">
        </div>
        <div>
          <label>Ø³ÙƒØ± (Ù…Ù„Ø¹Ù‚Ø©/ÙƒÙˆØ¨)</label>
          <input type="number" id="sugarPerCup" step="0.1" min="0" value="0.6">
        </div>
        <div>
          <label>Ø«Ù„Ø¬ (Ù‚Ø·Ø¹/ÙƒÙˆØ¨)</label>
          <input type="number" id="icePerCup" step="1" min="0" value="3">
        </div>
      </div>

      <h3>Ø´Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª</h3>
      <div class="grid-3">
        <div>
          <label>Ø´Ø±Ø§Ø¡ Ù„ÙŠÙ…ÙˆÙ† (0.10$/Ø­Ø¨Ø©)</label>
          <input type="number" id="buyLemons" step="1" min="0" value="0">
        </div>
        <div>
          <label>Ø´Ø±Ø§Ø¡ Ø³ÙƒØ± (0.05$/Ù…Ù„Ø¹Ù‚Ø©)</label>
          <input type="number" id="buySugar" step="1" min="0" value="0">
        </div>
        <div>
          <label>Ø´Ø±Ø§Ø¡ Ø£ÙƒÙˆØ§Ø¨ (0.03$/ÙƒÙˆØ¨)</label>
          <input type="number" id="buyCups" step="1" min="0" value="0">
        </div>
      </div>
      <div class="grid-3" style="margin-top:10px;">
        <div>
          <label>Ø´Ø±Ø§Ø¡ Ø«Ù„Ø¬ (0.01$/Ù‚Ø·Ø¹Ø©)</label>
          <input type="number" id="buyIce" step="1" min="0" value="0">
        </div>
        <div>
          <label>Ù‡Ø¯Ø± Ø§Ù„Ø«Ù„Ø¬ (ÙŠÙˆÙ…ÙŠØŒ %)</label>
          <input type="number" id="iceMeltPct" step="1" min="0" max="100" value="30">
          <div class="muted">Ø§Ù„Ø«Ù„Ø¬ ÙŠØ°ÙˆØ¨ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙŠÙˆÙ… (Ù„Ø§ ÙŠØªØ±Ø§ÙƒÙ…).</div>
        </div>
        <div>
          <label>Ø£Ù‚ØµÙ‰ Ø³Ø¹Ø© Ø®Ø¯Ù…Ø© Ø¨Ø§Ù„Ø³Ø§Ø¹Ø©</label>
          <input type="number" id="serviceRate" step="1" min="10" value="60">
          <div class="muted">ØªØ£Ø«ÙŠØ± Ø·ÙˆØ§Ø¨ÙŠØ± Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±.</div>
        </div>
      </div>

      <div class="row" style="margin-top:14px;">
        <button class="btn btn-primary" id="runDay">ØªØ´ØºÙŠÙ„ ÙŠÙˆÙ… Ø§Ù„Ø¨ÙŠØ¹</button>
        <button class="btn btn-secondary" id="endGame">Ø¥Ù†Ù‡Ø§Ø¡ Ù…Ø¨ÙƒØ±</button>
      </div>
      <div class="muted" style="margin-top:10px;">Ù†ØµÙŠØ­Ø©: Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø±ØªÙØ¹ ÙŠÙ‚Ù„Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ Ù„ÙƒÙ† Ø§Ù„ÙˆØµÙØ© Ø§Ù„Ø¬ÙŠØ¯Ø© ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙˆØ§Ù„Ø·Ù‚Ø³ Ø§Ù„Ø­Ø§Ø± ØªØ±ÙØ¹ Ø§Ù„Ø·Ù„Ø¨.</div>
    </section>

    <aside class="card">
      <h3>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
      <div class="grid-2">
        <div class="pill">ğŸ‹ Ù„ÙŠÙ…ÙˆÙ†: <span id="invLemons">50</span></div>
        <div class="pill">ğŸ§‚ Ø³ÙƒØ±: <span id="invSugar">80</span></div>
        <div class="pill">ğŸ¥¤ Ø£ÙƒÙˆØ§Ø¨: <span id="invCups">80</span></div>
        <div class="pill">ğŸ§Š Ø«Ù„Ø¬: <span id="invIce">200</span></div>
      </div>
      <hr/>
      <h3>ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</h3>
      <table id="dailyTable">
        <thead>
          <tr>
            <th>Ø§Ù„ÙŠÙˆÙ…</th><th>Ø·Ù‚Ø³</th><th>Ø³Ø¹Ø±</th><th>Ø¥Ø¹Ù„Ø§Ù†</th><th>Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†</th><th>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</th><th>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯</th><th>Ø§Ù„Ù…ØµØ±ÙˆÙ</th><th>Ø§Ù„Ø±Ø¨Ø­</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <hr/>
      <div><strong>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong> <span id="totalProfit">0.00</span> $</div>
    </aside>
  </main>

  <section class="card" style="margin: 0 16px 16px 16px;">
    <h3>Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ§Ù„Ø³Ø¬Ù„</h3>
    <div id="log" style="white-space: pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px; background:#111; color:#f1f1f1; padding:10px; border-radius:8px; max-height: 300px; overflow:auto;"></div>
  </section>

  <footer>Â© 2025 â€” Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ù„ÙŠÙ…ÙŠ. Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© ØªØ­Ø§ÙƒÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ© (1973/1979) Ù…Ø¹ Ø¥Ø¶Ø§ÙØ§Øª Ø·ÙÙŠÙØ©.</footer>

<script>
(function(){
  const totalDays = 12;
  let state = {
    day: 1,
    cash: 50.00,
    inv: { lemons: 50, sugar: 80, cups: 80, ice: 200 },
    totalProfit: 0,
  };

  const weatherTypes = [
    {name:"â˜€ï¸ Ø­Ø§Ø± Ø¬Ø¯Ù‹Ø§", demandBase: 120, priceTolerance: 0.9, note:"Ø·Ù„Ø¨ Ù…Ø±ØªÙØ¹ Ø¬Ø¯Ù‹Ø§"},
    {name:"ğŸŒ¤ï¸ Ù…Ø´Ù…Ø³",   demandBase: 100, priceTolerance: 1.0, note:"Ø£ÙØ¶Ù„ Ø£Ø¬ÙˆØ§Ø¡ Ù„Ù„Ø¨ÙŠØ¹"},
    {name:"â›…ï¸ ØºØ§Ø¦Ù…",    demandBase: 80,  priceTolerance: 1.05, note:"Ø·Ù„Ø¨ Ù…ØªÙˆØ³Ø·"},
    {name:"ğŸŒ§ï¸ Ù…Ù…Ø·Ø±",    demandBase: 55,  priceTolerance: 1.15, note:"Ø·Ù„Ø¨ Ø¶Ø¹ÙŠÙ"},
    {name:"â›ˆï¸ Ø¹Ø§ØµÙ",    demandBase: 25,  priceTolerance: 1.3, note:"Ø§Ø­ØªÙ…Ø§Ù„ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙŠÙˆÙ…"}
  ];

  const $ = (id)=>document.getElementById(id);
  $("totalDays").textContent = totalDays;

  function format(n){ return Number(n).toFixed(2); }

  function pickWeather(){
    // Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª ØªÙ‚Ø±ÙŠØ¨ÙŠØ©: Ø­Ø§Ø± Ø¬Ø¯Ù‹Ø§ 10%ØŒ Ù…Ø´Ù…Ø³ 40%ØŒ ØºØ§Ø¦Ù… 25%ØŒ Ù…Ù…Ø·Ø± 15%ØŒ Ø¹Ø§ØµÙ 10%
    const r=Math.random();
    if(r<0.10) return weatherTypes[0];
    if(r<0.50) return weatherTypes[1];
    if(r<0.75) return weatherTypes[2];
    if(r<0.90) return weatherTypes[3];
    return weatherTypes[4];
  }

  let todayWeather = pickWeather();
  function renderStatus(){
    $("day").textContent = state.day;
    $("cash").textContent = format(state.cash);
    $("invLemons").textContent = state.inv.lemons;
    $("invSugar").textContent  = state.inv.sugar;
    $("invCups").textContent   = state.inv.cups;
    $("invIce").textContent    = state.inv.ice;
    $("weatherLabel").textContent = todayWeather.name;
    $("weatherNote").textContent = " â€” " + todayWeather.note;
  }

  function log(msg){
    const now = new Date().toLocaleTimeString();
    $("log").textContent += `[${now}] ${msg}\n`;
    $("log").scrollTop = $("log").scrollHeight;
  }

  function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }

  function runDay(){
    const price = parseFloat($("price").value||0);
    const ads = parseInt($("ads").value||0);
    const cupsToMake = parseInt($("cupsToMake").value||0);

    const lemonsPerCup = parseFloat($("lemonsPerCup").value||0);
    const sugarPerCup  = parseFloat($("sugarPerCup").value||0);
    const icePerCup    = parseInt($("icePerCup").value||0);

    const buyLemons = parseInt($("buyLemons").value||0);
    const buySugar  = parseInt($("buySugar").value||0);
    const buyCups   = parseInt($("buyCups").value||0);
    const buyIce    = parseInt($("buyIce").value||0);

    const iceMeltPct = clamp(parseInt($("iceMeltPct").value||0),0,100);
    const serviceRate = Math.max(10, parseInt($("serviceRate").value||0));

    // Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
    const costLemon = 0.10, costSugar = 0.05, costCup=0.03, costIce=0.01, costAd=1.00;

    // ØªØ­Ù‚Ù‚ Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª
    const purchaseCost = buyLemons*costLemon + buySugar*costSugar + buyCups*costCup + buyIce*costIce + ads*costAd;
    if(purchaseCost > state.cash){
      log("âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±ØµÙŠØ¯ ÙƒØ§ÙÙ Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†.");
      return;
    }

    // ØªÙ†ÙÙŠØ° Ø§Ù„Ø´Ø±Ø§Ø¡
    state.cash -= purchaseCost;
    state.inv.lemons += buyLemons;
    state.inv.sugar  += buySugar;
    state.inv.cups   += buyCups;
    state.inv.ice    += buyIce;

    // Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø£ÙƒÙˆØ§Ø¨ ÙˆÙÙ‚ Ø§Ù„ÙˆØµÙØ© ÙˆØ§Ù„Ù…Ø®Ø²ÙˆÙ†
    const maxByLemons = Math.floor(state.inv.lemons / lemonsPerCup);
    const maxBySugar  = Math.floor(state.inv.sugar  / sugarPerCup);
    const maxByIce    = Math.floor(state.inv.ice    / icePerCup);
    const maxByCups   = state.inv.cups;
    const maxPossible = Math.min(maxByLemons, maxBySugar, maxByIce, maxByCups);

    const cupsReady = Math.min(cupsToMake, maxPossible);
    if(cupsReady < cupsToMake){
      log("âš ï¸ ØªÙ… Ø¥Ù†ØªØ§Ø¬ Ø¹Ø¯Ø¯ Ø£Ù‚Ù„ Ø¨Ø³Ø¨Ø¨ Ù‚ÙŠÙˆØ¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†.");
    }

    // Ø®ØµÙ… Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¥Ù†ØªØ§Ø¬
    state.inv.lemons -= Math.ceil(cupsReady * lemonsPerCup);
    state.inv.sugar  -= Math.ceil(cupsReady * sugarPerCup);
    state.inv.ice    -= Math.ceil(cupsReady * icePerCup);
    state.inv.cups   -= cupsReady;

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
    const base = todayWeather.demandBase;

    // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø³Ø¹Ø±: Ù†Ù‚Ø·Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© 0.5$
    const priceRef = 0.5 * todayWeather.priceTolerance;
    let priceFactor = (price<=priceRef) ? 1 + (priceRef-price)*0.8 : Math.max(0.1, 1 - (price-priceRef)*1.3);
    priceFactor = clamp(priceFactor, 0.1, 2.2);

    // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
    let adsFactor = 1 + Math.min(ads*0.06, 1.0);

    // Ø¬ÙˆØ¯Ø© Ø§Ù„ÙˆØµÙØ© (Ù†Ø·Ø§Ù‚Ø§Øª Ù…Ø¨Ø³Ø·Ø©)
    const ideal = { lemons:0.6, sugar:0.6, ice:3 };
    const recipeScore = (
      1 - Math.min( Math.abs(lemonsPerCup-ideal.lemons)/0.6, 1 )*0.35
      - Math.min( Math.abs(sugarPerCup-ideal.sugar)/0.6, 1 )*0.35
      - Math.min( Math.abs(icePerCup-ideal.ice)/3, 1 )*0.20
    );
    const recipeFactor = clamp(0.6 + recipeScore, 0.5, 1.3);

    // Ø£Ø­Ø¯Ø§Ø« Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© (Ù…Ø³ØªÙˆØ­Ø§Ø© Ù…Ù† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ©)
    let eventFactor = 1.0;
    let eventText = "";
    const r = Math.random();
    if(todayWeather.name.includes("â›ˆï¸")){
      if(r < 0.40){ // Ø§Ø­ØªÙ…Ø§Ù„ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙŠÙˆÙ…
        eventFactor = 0.0;
        eventText = "â›ˆï¸ Ø¹Ø§ØµÙØ© Ø£Ù„ØºØª Ø­Ø±ÙƒØ© Ø§Ù„Ø´Ø§Ø±Ø¹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„!";
      }
    } else if(r < 0.06){
      eventFactor = 0.4; eventText = "ğŸš§ Ø¥ØºÙ„Ø§Ù‚ Ø´Ø§Ø±Ø¹ Ù…Ø¬Ø§ÙˆØ± Ø®ÙÙ‘Ø¶ Ø§Ù„Ø­Ø±ÙƒØ©.";
    } else if(r >= 0.06 && r < 0.10){
      eventFactor = 0.7; eventText = "ğŸ‰ Ù…Ù‡Ø±Ø¬Ø§Ù† Ù‚Ø±ÙŠØ¨ Ø²Ø§Ø¯ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… Ù„ÙƒÙ† Ø²Ø§Ø¯Øª Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©.";
    }

    // Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„ÙŠÙ† Ù‚Ø¨Ù„ Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø®Ø¯Ù…Ø©
    let potential = Math.floor(base * priceFactor * adsFactor * recipeFactor * eventFactor);
    $("potential").textContent = potential>0? potential: 0;

    // Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø®Ø¯Ù…Ø© (Ø·Ø§Ø¨ÙˆØ±) â€” Ù†ÙØªØ±Ø¶ 8 Ø³Ø§Ø¹Ø§Øª Ø¨ÙŠØ¹
    const capacity = serviceRate * 8;
    const served = Math.min(potential, capacity, cupsReady);

    // Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
    const revenue = served * price;

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø¯
    state.cash += revenue;

    // Ø£Ø±Ø¨Ø§Ø­/Ø®Ø³Ø§Ø¦Ø± Ø§Ù„ÙŠÙˆÙ…
    // ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ ÙƒØ§Ù†Øª Ø¶Ù…Ù† Ø®ØµÙ… Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ù…Ù† Ø§Ù„Ø´Ø±Ø§Ø¡Ø› Ù‡Ù†Ø§ Ù†Ø­ØªØ³Ø¨ ÙÙ‚Ø· Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© (Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª+Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†).
    const dayCost = purchaseCost;
    const profit = revenue - dayCost;
    state.totalProfit += profit;

    // Ø¥Ø°Ø§Ø¨Ø© Ø§Ù„Ø«Ù„Ø¬ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
    const melt = Math.floor(state.inv.ice * (iceMeltPct/100));
    state.inv.ice = Math.max(0, state.inv.ice - melt);

    // Ø³Ø¬Ù„
    const dayIdx = state.day;
    log(`Ø§Ù„ÙŠÙˆÙ… ${dayIdx}: Ø·Ù‚Ø³ ${todayWeather.name} â€” Ø³Ø¹Ø± ${price.toFixed(2)}$ â€” Ø¥Ø¹Ù„Ø§Ù† ${ads} â€” Ø¬Ù‡Ø²Øª ${cupsReady} ÙƒÙˆØ¨ â€” Ø®Ø¯Ù…Ù†Ø§ ${served} / ${potential} Ø¹Ù…ÙŠÙ„ â€” Ø¥ÙŠØ±Ø§Ø¯ ${revenue.toFixed(2)}$ â€” Ù…ØµØ±ÙˆÙ ${dayCost.toFixed(2)}$ â€” Ø±Ø¨Ø­ ${profit.toFixed(2)}$.`);
    if(eventText) log("Ø­Ø¯Ø«: " + eventText);
    if(cupsReady>served) log(`ğŸ“¦ ØªØ¨Ù‚Ù‰ ${cupsReady-served} ÙƒÙˆØ¨ Ù„Ù… ÙŠÙØ¨Ø§Ø¹.`);
    if(melt>0) log(`ğŸ§Š Ø°Ø§Ø¨ ${melt} Ù…Ù† Ø§Ù„Ø«Ù„Ø¬ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ.`);

    // Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${dayIdx}</td><td>${todayWeather.name}</td><td>${price.toFixed(2)}</td><td>${ads}</td><td>${potential}</td><td>${served}</td><td>${revenue.toFixed(2)}</td><td>${dayCost.toFixed(2)}</td><td>${profit.toFixed(2)}</td>`;
    document.querySelector("#dailyTable tbody").appendChild(tr);

    $("totalProfit").textContent = format(state.totalProfit);

    // Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ
    state.day += 1;
    if(state.day>totalDays){
      endGame();
    }else{
      todayWeather = pickWeather();
      renderStatus();
    }
  }

  function endGame(){
    $("runDay").disabled = true;
    $("endGame").disabled = true;
    log(`ğŸ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©. Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${format(state.totalProfit)}$. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${format(state.cash)}$.`);
    alert("Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø§Ù†Ø¸Ø± Ø§Ù„Ø³Ø¬Ù„ ÙˆØ§Ù„Ø¬Ø¯ÙˆÙ„ Ù„Ù…Ø¹Ø±ÙØ© Ø£Ø¯Ø§Ø¡Ùƒ.");
  }

  $("runDay").addEventListener("click", runDay);
  $("endGame").addEventListener("click", endGame);

  renderStatus();
})();
</script>
</body>
</html>
